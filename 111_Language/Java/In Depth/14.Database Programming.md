# The Design of JDBC
- Java provides a pure Java API for SQL access along with a driver manager to allow third-party drivers to connect to specific databases. 
- Database vendors could provide their own drivers to plug into the driver manager. 
- There would then be a simple mechanism for registering third-party drivers with the driver manager. 
- This organization follows the very successful model of Microsoft’s ODBC which provided a C programming language interface for database access. 
- Both JDBC and ODBC are based on the same idea : 
	- Programs written according to the API talk to the driver manager, which, in turn, uses a driver to talk to the actual database.
### JDBC Driver Types
1. A `type 1` driver translates `JDBC` to `ODBC` and relies on an `ODBC driver` to communicate with the `database`. 
	- Early versions of Java included one such driver, the `JDBC/ODBC bridge`.
	- JDK no longer provides the `JDBC/ODBC bridge`.
2. A `type 2` driver is written partly in Java and partly in native code. 
	- It communicates with the client API of a database. 
	- To use such a driver, you must install some platform-specific code onto the client in addition to a Java library.
3. A `type 3` driver is a pure Java client library that uses a database independent protocol to communicate database requests to a server component, which then translates the requests into a database-specific protocol. 
	- This simplifies deployment because the platform-specific code is located only on the server.
4. A `type 4` driver is a pure Java library that translates JDBC requests directly to a database-specific protocol.
- Most database vendors supply either a type 3 or type 4 driver with their database
### The ultimate goal of JDBC is to make possible the following:
- Programmers can write applications in the Java programming language to access any database using standard SQL statements (or even specialized extensions of SQL) while still following Java language conventions.
- Database vendors and database tool vendors can supply the low-level drivers. Thus, they can optimize their drivers for their specific products.
### Why Java didn't adopt ODBC model ?
- ODBC is hard to learn.
- ODBC has a few commands with lots of complex options. The preferred style in the Java programming language is to have simple and intuitive methods, but to have lots of them.
- ODBC relies on the use of void* pointers and other C features that are not natural in the Java programming language.
- An ODBC-based solution is inherently less safe and harder to deploy than a pure Java solution.
### Typical Uses of JDBC
#### Tradition Client/Server application
- The traditional client/server model has a rich GUI on the client and a database on the server. 
- In this model, a JDBC driver is deployed on the client.

- ![](Pasted_image_20231008123037.png)

#### 3-tier architecture
- Nowadays it is far more common to have a three-tier model where the client application does not make database calls. 
- Instead, it calls on a middleware layer on the server that in turn makes the database queries. 
- The three-tier model has a couple of advantages :
	- It separates visual presentation (on the client) from the business logic (in the middle tier) and the raw data (in the database). 
	- Therefore, it becomes possible to access the same data and the same business rules from multiple clients, such as a Java desktop application, a web browser, or a mobile app. 
	- Communication between the client and the middle tier typically occurs through HTTP. 
	- JDBC manages the communication between the middle tier and the back-end database.

-  ![](Pasted_image_20231008123418.png)

# The Structured Query Language
- JDBC lets you communicate with databases using SQL, which is the command language for essentially all modern relational databases. 
- The **JDBC package is an API for communicating SQL statements to databases**.
- A database has a bunch of named tables with rows and columns. Each column has a column name. Each row contains a set of related data.
- The **benefit of joining tables** **is avoiding unnecessary duplication of data in the database tables**.
- **In the relational model, we distribute data into multiple tables so that no information is unnecessarily duplicated.**

### SQL
1. Note that strings are enclosed in single quotes, not double quotes. A single quote inside a string is represented by a pair of single quotes.
```sql
SELECT Title FROM Books WHERE Title LIKE '%''%' 
 -- reports all titles that contain a single quote.
```
2. You can select data from multiple tables :
```sql
SELECT * FROM Books, Publishers
```
- Without a `WHERE` clause, this query is not very interesting. It lists all combinations of rows from both tables.
3. Whenever you have multiple tables in a query, the same column name can occur in two different places.
	- When an ambiguity would otherwise result, you must prefix each column name with the name of the table to which it belongs, such as `Books.Publisher_Id`.
4. You need a separate `INSERT` statement for every row being inserted in the table.

#### Common SQL Data Types

![](Pasted_image_20231008124747.png)

# JDBC Configuration
- You need a database program for which a JDBC driver is available. 
- There are many excellent choices, such as IBM DB2, Microsoft SQL Server, MySQL, Oracle, and PostgreSQL.
### Database URLs
- When connecting to a database, you must use various database-specific parameters such as `host names`, `port numbers`, and `database names`.
```java
jdbc:derby://localhost:1527/COREJAVA;create=true 
jdbc:postgresql:COREJAVA
```
- These JDBC URLs specify a Derby database and a PostgreSQL database named `COREJAVA`.
- The general syntax is :
```java
jdbc:subprotocol:other stuff
```
- where a subprotocol selects the specific driver for connecting to the database.
### Driver JAR Files
- You need to obtain the JAR file in which the driver for your database is located.
- Include the driver JAR file on the class path when running a program that accesses the database. 
- You don’t need the JAR file for compiling.
- When you launch programs from the command line, simply use the command
>	java -classpath driverPath:. ProgramName

- On Windows, use a semicolon to separate the current directory (denoted by the . character) from the driver JAR location.
### Starting the Database
- The database server needs to be started before you can connect to it.
- With the Derby database, follow these steps:
	1. Open a command shell and change to a directory that will hold the database files.
	2. Locate the file derbyrun.jar. With some versions of the JDK, it is contained in the jdk/db/lib directory. If it’s not there, install Apache Derby and locate the JAR file in the installation directory. We will denote the directory containing lib/derbyrun.jar with derby.
	3. Run the command java -jar derby/lib/derbyrun.jar server start